"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cloudrunCommand = void 0;
const studio_server_1 = require("@remotion/studio-server");
const log_1 = require("./log");
const cloudrunCommand = async (remotionRoot, args, logLevel) => {
    try {
        const path = require.resolve('@remotion/cloudrun', {
            paths: [remotionRoot],
        });
        const { CloudrunInternals } = require(path);
        await CloudrunInternals.executeCommand(args, remotionRoot, logLevel);
        process.exit(0);
    }
    catch (err) {
        const manager = studio_server_1.StudioServerInternals.getPackageManager(remotionRoot, undefined, 0);
        const installCommand = manager === 'unknown' ? 'npm i' : manager.installCommand;
        log_1.Log.error({ indent: false, logLevel }, err);
        log_1.Log.error({ indent: false, logLevel }, 'Remotion Cloud Run is not installed.');
        log_1.Log.info({ indent: false, logLevel }, '');
        log_1.Log.info({ indent: false, logLevel }, 'You can install it using:');
        log_1.Log.info({ indent: false, logLevel }, `${installCommand} @remotion/cloudrun@${studio_server_1.StudioServerInternals.getRemotionVersion()}`);
        process.exit(1);
    }
};
exports.cloudrunCommand = cloudrunCommand;
